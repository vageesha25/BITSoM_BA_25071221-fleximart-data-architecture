import{D as s,e as o,a as p}from"./DatabaseType-BbdbLm9P.js";import{a as A,c as a,d as E}from"./viewUtil-CTdDvppq.js";function U(t){return t==null?!0:typeof t=="string"?["","NULL","undefined"].includes(t.toUpperCase()):!1}function u(t,e){if(c(t)&&typeof e=="string"){if(/boolean/i.test(t)){if(/^true$/i.test(e))return!0;if(/^false$/i.test(e))return!1}const n=/float|double|decimal/i.test(t)||e.includes(".")?parseFloat(e):parseInt(e);if(n!=null&&!isNaN(n))return n>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER?e:n}return null}function T(t){return typeof t!="string"?t:t.replace(/ /g," ")}function j(t){return typeof t!="string"?t:t.replace(/(^'|'$)/g,"")}class m{isSupport(e){return A(e)}convert(e,r,n){if(typeof r=="string"&&r.startsWith("0x")){const i=r.slice(2);switch(n){case s.PG:return`'\\x${i}'`;case s.REDSHIFT:return`from_hex('${i}')`;case s.libSQL:case s.SQLITE:case s.DUCK_DB:return`x'${i}'`;case s.SNOWFLAKE:return`TO_BINARY('${i}', 'hex')`}return r}else switch(n){case s.DB2:return`CAST('${r}' AS BLOB)`;case s.SQLServer:return`CAST('${r}' AS varbinary)`;case s.DM:case s.ORACLE:return`rawtohex('${r}')`;case s.CASSANDRA:return`textAsBlob('${r}')`}}}class y{isSupport(e){return e.match(/DATE/i)!=null}convert(e,r,n){switch(n){case s.TRINO:return`from_iso8601_timestamp('${r}')`;case s.ORACLE:return`TO_DATE('${r}','yyyy/mm/dd hh24:mi:ss')`}}}class N{isSupport(e,r,n){return n==s.ORACLE&&e.match(/TIMESTAMP/i)!=null}convert(e,r,n){return`TO_TIMESTAMP('${r}','yyyy/mm/dd hh24:mi:ss')`}}class C{isSupport(e,r,n){return[s.ES,s.MONGO_DB].includes(n)}convert(e,r,n){return u(e,r)??r}}class b{isSupport(e,r,n){return!0}convert(e,r,n){typeof r=="string"&&(r=r.replace(/'/g,"''"));const i=`'${r}'`;return o(n)?i.replace(/\\/g,"\\\\"):i}}class R{isSupport(e,r,n){return c(e)}convert(e,r,n){return u(e,r)}}class D{isSupport(e,r,n){return/bit/i.test(e)}convert(e,r,n){return o(n)?`b'${r}'`:p(n)?`B'${r}'`:n==s.SQLServer&&typeof r=="string"&&r?.match(/true|false/i)?`'${r}'`:r}}class _{isSupport(e,r,n){return/^(bool|boolean)$/i.test(e)&&/true|false/i.test(r)}convert(e,r,n){return r}}class L{isSupport(e){return!0}convert(e,r,n){const i=typeof r=="string";switch(n){case s.CASSANDRA:if(e?.match(/uuid/i))return r;break;case s.PG:case s.REDSHIFT:if(i&&r.includes("nextval("))return r;break;case s.SQLServer:if(a(e))return`N'${r.replace(/'/g,"''")}'`;break;case s.TRINO:if(i&&e?.match(/json/i))return`json_parse('${r.replace(/'/g,"''").replace(/ /g," ").replace(/\\/g,"\\\\")}')`}}}class O{isSupport(e,r,n){return o(n)&&E(e)}convert(e,r,n){if(typeof r=="string"&&r.match(/\w+\(/))return`ST_GeomFromText('${r}')`}}class ${isSupport(e,r,n){return["jsonb","json","object"].some(S=>e.toLowerCase().includes(S))&&(typeof r=="object"&&r!==null)}convert(e,r,n){try{return`'${JSON.stringify(r).replace(/'/g,"''")}'`}catch{return null}}}const I=[new C,new D,new R,new _,new m,new y,new N,new O,new L,new $,new b];function w(t,e,r){t||(t=""),(e===null||typeof e!="object")&&(e=`${e}`);for(const n of I)if(n.isSupport(t,e,r)){const i=n.convert(t,e,r);if(i!=null)return i}}const h=new Set(["ACCOUNT","ACTION","ALL","ANY","BACKUP","BEGIN","CHARACTER","CONDITION","CURRENT","DATA","DATE","DESC","EXPLAIN","FROM","GRANT","GROUP","GROUPS","INDEX","JOIN","KEY","LENGTH","ORDER","PRIMARY","REGEXP","SIGNAL","SOURCE","SYSTEM","TABLE","TYPE","UNION","USER","VALUE","DATABASE","SCHEMA","VIEW","PROCEDURE","FUNCTION","TRIGGER","EVENT","SEQUENCE","COLUMN","DEFAULT","SET","TEMPORARY","OPEN"]);var B=(t=>(t.True="true",t.False="false",t.Never="never",t.Always="always",t.Auto="auto",t))(B||{});function f(t){return t?.includes(".")?t.split(".").map(e=>f(e)).join("."):t?.replace(/^[`"\[](.+?)[`"\]]$/,"$1")}function F(t,e,r=!0){if(t==null||["MongoDB"].includes(e)||r=="never"||(r==!0&&(r="always"),r==!1&&(r="auto"),e==s.JDBC&&r=="auto"))return t;const n=t.match(/[A-Z]/g)&&![s.SNOWFLAKE,s.ORACLE,s.DM,s.DB2,s.AS400,s.EXASOL].includes(e),i=/[~!@#$%^&*()/\s\|,.<>?"'();:+\-=\[\]{}]|^[0-9]/;return r=="always"||n||t.match(i)||h.has(t.toUpperCase())?(t=f(t),[s.MYSQL,s.MARIA_DB,s.DORIS,s.NEO4J,s.BIG_QUERY,s.DATABRICKS,s.TDengine].includes(e)?`\`${t}\``:`"${t}"`):t}function G(t,e,r){if(e==null||e===""&&!a(t))return"null";typeof e=="object"&&e?.origin&&(e=e.origin),e=T(e);const n=w(t,e,r);if(n!=null)return n}function P(t,e){return c(e)?t:`'${t}'`}function c(t){if(!t||typeof t=="number"||t.includes("[]")||t=="interval")return!1;const e=["int","number","numeric","serial","float","double","decimal","real","bool","boolean"];return!t.match(/point/i)&&t.match(new RegExp(e.join("|"),"i"))!=null}export{B as E,j as a,F as b,U as c,P as g,c as i,u as s,T as t,G as w};
